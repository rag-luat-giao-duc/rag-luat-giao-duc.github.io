(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{48:function(e,t,a){},50:function(e,t,a){},51:function(e,t,a){},52:function(e,t,a){},53:function(e,t,a){},54:function(e,t,a){},55:function(e,t,a){},56:function(e,t,a){},57:function(e,t,a){},58:function(e,t,a){},59:function(e,t,a){},60:function(e,t,a){"use strict";a.r(t),t.default=a.p+"static/media/alert.439ffe7a.wav"},61:function(e,t,a){"use strict";a.r(t);var s=a(3),n=a.n(s),c=a(36),r=a.n(c),i=a(38),o=a(5),l=a.n(o),d=a(11),u=a(62),m=a(19),g=a.n(m),j=u.a.create({baseURL:"https://api-rag-luat-giao-duc.azurewebsites.net/"}),h=function(){var e=Object(d.a)(l.a.mark((function e(t,a){var s,n,c,r,i=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=i.length>2&&void 0!==i[2]?i[2]:{},e.prev=1,n=g.a.get("apiKey"),c={method:t,url:a,data:s,headers:{"Content-Type":"application/json","api-key":n||""}},e.next=6,j.request(c);case 6:return r=e.sent,e.abrupt("return",r);case 10:throw e.prev=10,e.t0=e.catch(1),e.t0;case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,a){return e.apply(this,arguments)}}();function p(){return(p=Object(d.a)(l.a.mark((function e(t,a){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={UserNameOrEmail:t,Password:a},e.next=3,h("POST","/api/user/login",s);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(){return(b=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("GET","/api/chat/get-list-chat-history");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}a(48);var x,v=a.p+"static/media/close.4a115b27.svg",f=a.p+"static/media/close-dark.37ff4c0f.svg",O=a(1),y=function(e){var t=e.dark,a=e.show,n=e.message,c=e.timeout,r=void 0===c?2500:c,i=e.onChange;return Object(s.useEffect)((function(){a&&(clearTimeout(x),x=setTimeout((function(){i&&i(!1)}),r))}),[a,r,i]),Object(O.jsxs)("div",{className:"alert alert--".concat(a?"active":"inactive"),children:[Object(O.jsx)("div",{className:"alert__message",children:n}),Object(O.jsx)("div",{className:"alert__icon",onClick:function(){return i&&i(!1)},children:Object(O.jsx)("img",{alt:"close",className:"close__icon",src:t?f:v})})]})},_=(a(50),a(51),function(e){var t=e.name,a=e.altBg,s=void 0!==a&&a;return Object(O.jsx)("div",{title:t,className:"avatar ".concat(s?"avatar--bg":"").trim(),children:function(){var e="";if(t){var a=t[0],s=t[1];a&&(e+=a),s&&(e+=s)}return e.toUpperCase()}()})});a(52);var w=({children:e,block:t=!1,onClick:a,color:s})=>Object(O.jsx)("button",{onClick:e=>a&&a(e),className:"message__text__hint button ".concat(t?"button--block":"").trim(),style:{backgroundColor:s},children:e});a(53);var k=({name:e,text:t,timestamp:a,user:s})=>{const n=()=>s.toLowerCase()===e.toLowerCase();return Object(O.jsx)("div",{className:"message__wrapper ".concat(n()?"message__wrapper--right":"message__wrapper--left").trim(),children:"bot"===s.toLowerCase()||"system"===s.toLowerCase()?Object(O.jsx)("div",{className:"message__bot",dangerouslySetInnerHTML:{__html:(e=>{let t="",a=[],s=0;for(;s<e.length;)"*"===e[s]&&"*"===e[s+1]?a.length>0&&"**"===a[a.length-1]?(t+="</b>",a.pop(),s+=2):(t+="<b>",a.push("**"),s+=2):"*"===e[s]?a.length>0&&"*"===a[a.length-1]?(t+="</i>",a.pop(),s+=1):(t+="<i>",a.push("*"),s+=1):(t+=e[s],s+=1);for(;a.length>0;){t+="**"===a.pop()?"</b>":"</i>"}return t})(t)}}):Object(O.jsxs)(O.Fragment,{children:[!n()&&Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(_,{name:s}),Object(O.jsx)("div",{style:{width:"8px"}})]}),Object(O.jsxs)("div",{className:"message__container ".concat(n()?"message__container--right":"").trim(),children:[Object(O.jsx)("div",{className:"message__text",children:t}),Object(O.jsx)("div",{className:"message__timestamp ".concat(n()?"message__timestamp--right":"").trim(),children:a})]}),n()&&Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("div",{style:{width:"8px"}}),Object(O.jsx)(_,{name:s})]})]})})};a(54);var S=({className:e="",type:t,value:a,placeholder:n,icon:c=!1,onIconClick:r,onKeyPress:i,onChange:o,sending:l,suggestions:d,setUseModel:u,useModel:m})=>{const g=(e,t)=>{"#"!==t?(h(!1),e&&e(t)):h(!0)},[j,h]=Object(s.useState)(!1);return Object(O.jsxs)("div",{className:"input__wrapper ".concat(e).trim(),children:[m&&m.name&&Object(O.jsxs)("div",{className:"input__use__model",title:m.desc,children:[Object(O.jsx)("div",{className:"input__use__model__close",onClick:()=>{u(""),h(!0)},children:"X"}),m.name]}),Object(O.jsx)("input",{type:t,value:a,placeholder:n,onKeyPress:e=>g(i,e.key),onChange:({target:{value:e}})=>g(o,e),className:"input ".concat(c?"input--shrunk":"").trim(),onClick:()=>h(!1),disabled:l}),j&&Object(O.jsx)("ul",{className:"suggestions",children:d.length>0&&d.map((e=>Object(O.jsx)("li",{onClick:()=>{console.log(e),e&&(e=>{u(e),console.log(e),h(!1)})(e)},title:e.desc,children:e.name},e.name)))}),c&&Object(O.jsx)("div",{className:"input__send",onClick:e=>g(r,e),children:Object(O.jsx)("img",{className:"send_icon",src:c,alt:"send"})})]})};a(55);var N=({setMessage:e,onSend:t,text:a})=>Object(O.jsx)("div",{className:"message__wrapper 'message__wrapper--left'\n      }".trim(),children:Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("div",{style:{width:"8px"}}),Object(O.jsx)(_,{name:"Admin"})]}),Object(O.jsxs)("div",{className:"message__container".trim(),children:[Object(O.jsxs)("div",{className:"message__text",children:[a,Object(O.jsx)("br",{}),Object(O.jsx)("br",{}),[{text:"Lu\u1eadt gi\xe1o d\u1ee5c do ai ban h\xe0nh",color:"#6B5B95"},{text:"B\u1ea1n c\xf3 th\u1ec3 l\xe0m \u0111\u01b0\u1ee3c g\xec",color:"#92A8D1"},{text:"H\u1ecdc b\u1ed5ng \u0111\u01b0\u1ee3c quy \u0111\u1ecbnh th\u1ebf n\xe0o",color:"#B565A7"},{text:"Gi\u1ea3ng vi\xean l\xe0 ai",color:"#5B5EA6"},{text:"C\xf3 bao nhi\xeau \u0111i\u1ec1u trong lu\u1eadt gi\xe1o d\u1ee5c",color:"#98B4D4"}].map(((a,s)=>Object(O.jsx)(w,{onClick:()=>{e(a.text),t()},color:a.color,children:a.text},s)))]}),Object(O.jsx)("div",{className:"message__timestamp".trim()})]})]})}),C=(a(56),a.p+"static/media/send.623ea14f.svg"),M=a.p+"static/media/send-dark.2eaae009.svg";var T=({suggestions:e,sending:t,dark:a,onSend:n,message:c,messages:r,setMessage:i,name:o,setUseModel:l,useModel:d})=>{const u=Object(s.useRef)(null),[m,g]=Object(s.useState)(!1);return Object(s.useLayoutEffect)((()=>{if(u.current){const e=u.current;e.scrollTop=e.scrollHeight}}),[r,m]),Object(s.useEffect)((()=>{1===r.length&&"ADMIN"===r[0].user?setTimeout((()=>{g(!0)}),15e3):g(!1)}),[r]),Object(O.jsxs)("div",{className:"messages__wrapper",children:[Object(O.jsxs)("div",{ref:u,className:"messages__container",children:[r.map((({text:e,timestamp:t,user:a},s)=>Object(O.jsx)(k,{user:a,text:e,name:o,timestamp:t},s))),m?Object(O.jsx)(N,{text:"H\xe3y b\u1eaft \u0111\u1ea7u b\u1eb1ng v\xe0i c\xe2u h\u1ecfi ph\u1ed5 bi\u1ebfn n\xe8!",setMessage:i,onSend:n}):null]}),Object(O.jsx)(S,{value:c,onIconClick:()=>n(),placeholder:t?"Solving...":"Type message here",icon:a?M:C,onChange:e=>i(e),onKeyPress:e=>"Enter"===e?n():null,sending:t,suggestions:e,setUseModel:l,useModel:d})]})},D=(a(57),a.p+"static/media/sun.f47b12ec.svg"),E=a.p+"static/media/moon.f63d4641.svg",P=a.p+"static/media/menu.6d253151.svg",L=a.p+"static/media/menu-dark.9aab1937.svg";var A=({dark:e,username:t,sending:a,message:n,messages:c,setMessage:r,onTheme:i,onSend:o,suggestions:l,setUseModel:d,useModel:u})=>{const[m,j]=Object(s.useState)(!1),[p,b]=Object(s.useState)(!1);return Object(s.useEffect)((()=>{let e=0;const t=async()=>{try{let a=await async function(){return await h("GET","/api/user/check-connection-ready")}();a&&200===a.status&&a.data&&(a.data.Data?b(!0):(setTimeout((()=>{t()}),15e3),e++))}catch{b(!1),e<3?(setTimeout((()=>{t()}),15e3),e++):console.log("Connection failed, wait a moment and try again.")}};t()}),[]),Object(O.jsx)("div",{className:"chat__wrapper",children:Object(O.jsxs)("div",{className:"chat__container",children:[Object(O.jsxs)("div",{className:"chat__header",children:[Object(O.jsx)("div",{className:"chat__menu",onClick:()=>j(!m),children:Object(O.jsx)("img",{src:e?L:P,alt:"menu"})}),Object(O.jsx)("div",{className:"".concat(p?"chat__connection-open":"chat__connection-close"),title:p?"Ready to use":"Wait for connection start"}),Object(O.jsx)("div",{title:t,className:"chat__name",children:"Chatapp"}),Object(O.jsx)("div",{style:{flexGrow:1}}),Object(O.jsxs)("div",{className:"chat__actions",children:[Object(O.jsx)("div",{className:"chat__theme",onClick:()=>i&&i(!e),children:Object(O.jsx)("img",{src:e?D:E,alt:"theme"})}),Object(O.jsx)(w,{onClick:()=>{g.a.remove("apiKey"),window.location.reload()},children:"LEAVE"})]})]}),Object(O.jsx)("div",{className:"chat__body",children:Object(O.jsx)("div",{className:"chat__messages",children:Object(O.jsx)(T,{dark:e,name:t,onSend:o,message:n,messages:c,setMessage:r,sending:a,suggestions:l,setUseModel:d,useModel:u})})})]})})};a(58);var I=({onJoin:e})=>{const[t,a]=Object(s.useState)(""),[n,c]=Object(s.useState)("");return Object(O.jsx)("div",{className:"join__wrapper",children:Object(O.jsxs)("div",{className:"join__container",children:[Object(O.jsx)(S,{type:"text",placeholder:"Username",onChange:e=>a(e)}),Object(O.jsx)("div",{style:{height:"24px"}}),Object(O.jsx)(S,{type:"password",placeholder:"Password",onChange:e=>c(e),onKeyPress:a=>{a&&JSON.stringify(a).includes("Enter")&&e&&e({username:t,password:n})}}),Object(O.jsx)("div",{style:{height:"36px"}}),Object(O.jsx)(w,{block:!0,onClick:()=>e&&e({username:t,password:n}),children:"GO!"}),Object(O.jsx)("div",{className:"join__info",children:"i"}),Object(O.jsx)("div",{className:"join__description",children:"Join a private own beta chat bot!"})]})})},K={"--text-color-primary":"rgba(0, 0, 0, 0.86)","--text-color-secondary":"rgba(0, 0, 0, 0.7)","--text-color-disabled":"rgba(0, 0, 0, 0.56)","--primary-bg":"#f3f6ff","--primary":"#2255be","--white":"#ffffff","--black":"#222222"},U={"--text-color-primary":"rgba(255, 255, 255, 1)","--text-color-secondary":"rgba(255, 255, 255, 0.8)","--text-color-disabled":"rgba(255, 255, 255, 0.56)","--primary-bg":"#292929","--primary":"#2255be","--white":"#3d3d3d","--black":"#000000"},B=function(e){var t=document.querySelector(":root"),a=Object.keys(e);t&&e&&a.forEach((function(a){var s,n,c,r=e[a];r&&a.startsWith("--")&&(n=a,c=r,(s=t)&&c&&s.style.setProperty(n,String(c)))}))};a(59);const F=a(60),G=new Audio(F.default);let J=Object(i.a)("/",{transports:["websocket"]});var H=()=>{const[e,t]=Object(s.useState)(""),[a,n]=Object(s.useState)(""),[c,r]=Object(s.useState)(""),[i,o]=Object(s.useState)(""),[l,d]=Object(s.useState)([]),[m,j]=Object(s.useState)(!1),[x,v]=Object(s.useState)(!1),[f,_]=Object(s.useState)(!1),[w,k]=Object(s.useState)(""),[S,N]=Object(s.useState)(!1),[C,M]=Object(s.useState)([]),T=async(e,t)=>{try{const a=await function(e,t){return p.apply(this,arguments)}(e,t);return 200===a.data.StatusCode?a.data.Data.APIKey&&a.data.Data.ExpiredTime?a.data.Data.ExpiredTime<(new Date).getTime()?(k("Login failed. Your API key has expired."),void _(!0)):(g.a.set("apiKey",a.data.Data.APIKey,{expires:1}),v(!0),k("Login successful."),void _(!0)):(k("Login failed. Please check your credentials and try again."),void _(!0)):/\u0027.*?\u0027/.test(a.data.Message.toLowerCase())?(k("Database be loading... Try again later!"),_(!0),void D()):(k("Login failed. Please check your credentials and try again."),void _(!0))}catch(s){var a;if(u.a.isAxiosError(s))console.error("Login failed:",null===(a=s.response)||void 0===a?void 0:a.data),k("Login failed. Please check your credentials and try again.");else console.error("An unexpected error occurred:",s),k("An unexpected error occurred. Please try again.");return _(!0),void D()}};Object(s.useEffect)((()=>{const e=async()=>{try{const e=await async function(){const e=g.a.get("apiKey");return e?await h("GET","/api/user/check-api-key?id="+e):null}();e&&200===e.status?200===e.data.StatusCode?(v(!0),t(e.data.Data.UserName||"")):-99===e.data.StatusCode&&(k("API key not found"),_(!0)):(k("API key is invalid. Please login again."),_(!0),D())}catch{D()}},a=e=>{const t=new Date(e),a=new Date,s=t.getHours().toString().padStart(2,"0"),n=t.getMinutes().toString().padStart(2,"0"),c="".concat(s,":").concat(n),r=a.getTime()-t.getTime(),i=Math.floor(r/864e5);if(0===i)return c;if(1===i)return"Yesterday, ".concat(c);if(i>=2&&i<=7)return"".concat(i," days ago, ").concat(c);{const e=Math.floor(i/7),a=t.toLocaleDateString("vi-VN",{weekday:"long"});return"".concat(a,", ").concat(e," weeks ago, ").concat(c)}},s=e=>({text:e.Message,timestamp:a(e.CreatedAt),user:"system"===e.Sender.toLowerCase()?"system":e.Sender}),n=async()=>{try{const e=await function(){return b.apply(this,arguments)}();if(200===e.status&&null!==e.data.Data){const t=e.data.Data.map(s);d(t)}else 200===e.status&&-99===e.data.StatusCode&&"Not exist data"===e.data.Message&&setTimeout((()=>{d([{text:"Send a first message \ud83d\udc47\ud83d\udc47\ud83d\udc47",timestamp:"Welcome to chat app",user:"ADMIN"}])}),2e3)}catch(e){console.error("Error fetching messages:",e)}};!1===x?e():n(),J.on("leave",(({error:e,devMessage:t})=>{console.error({error:e,devMessage:t}),D()})),E("true"===localStorage.getItem("dark"))}),[x]);const D=()=>{Object.keys(g.a.get()).forEach((e=>{g.a.remove(e)})),k(""),_(!1),v(!1),d([]),o(""),r(""),t(""),n("")},E=e=>{localStorage.setItem("dark",String(e)),j(e),B(e?U:K)};return Object(O.jsxs)("div",{className:"app",children:[Object(O.jsx)(y,{dark:m,show:f,message:w,onChange:e=>_(e)}),x?Object(O.jsx)(A,{dark:m,username:e,password:a,apiKey:c,message:i,messages:l,onSend:async t=>{if(t&&t.preventDefault(),i)try{let t={text:i,timestamp:(new Date).toTimeString().slice(0,5),user:e};1===l.length&&"ADMIN"===l[0].user?d([t]):d((e=>[...e,t])),o(""),N(!0);const a=await async function(e,t){return await h("POST","/api/chat/send-message",{Message:e,Model:t})}(t.text,C.name);if(N(!1),200===a.status){let e=a.data.Data;G.play(),e&&(e={text:e.Message,timestamp:new Date(e.CreatedAt).getTime(),user:e.Sender},d((t=>[...t,e])))}else k("Error sending message. Please try again."),_(!0)}catch(a){console.error("Error sending message:",a)}},onTheme:E,setMessage:o,sending:S,suggestions:[{name:"llama",desc:"l\xe0 model g\u1ed1c t\u1eeb nh\xe0 ph\xe1t tri\u1ec3n Ollama model n\xe0y ch\u1ee9a 7B tham s\u1ed1 bao g\u1ed3m ti\u1ebfng Vi\u1ec7t"},{name:"custom llama",desc:"d\u1ef1a tr\xean model llama nh\u01b0ng \u0111\u01b0\u1ee3c fine-tune tr\xean d\u1eef li\u1ec7u ti\u1ebfng Vi\u1ec7t v\u1edbi 120k c\xe2u li\xean quan \u0111\u1ebfn lu\u1eadt n\xf3i chung"},{name:"open text generater",desc:"s\u1eed d\u1ee5ng model Gemini c\u1ee7a Google nh\u01b0ng \u0111\u01b0\u1ee3c tuned l\u1ea1i \u0111\u1ec3 ph\xf9 h\u1ee3p v\u1edbi ng\u1eef c\u1ea3nh c\xe2u h\u1ecfi"}],useModel:C,setUseModel:M}):Object(O.jsx)(I,{onJoin:({username:e,password:a})=>{t(e),n(a),T(e,a),J.emit("join",{username:e,password:a},(e=>{if(e)return k(e),void _(!0);v(!0)}))}})]})},q=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,63)).then((function(t){var a=t.getCLS,s=t.getFID,n=t.getFCP,c=t.getLCP,r=t.getTTFB;a(e),s(e),n(e),c(e),r(e)}))};r.a.render(Object(O.jsx)(n.a.StrictMode,{children:Object(O.jsx)(H,{})}),document.getElementById("root")),q()}},[[61,1,2]]]);
//# sourceMappingURL=main.1d990ab3.chunk.js.map